##
Reading in cross, assembly and marker info
##
[1] "Wed Feb 10 00:15:25 2021"
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
[1] 6
 --Read the following data:
	 99  individuals
	 7380  markers
	 2  phenotypes
 --Cross type: riself 
dropping 0 terminal markers
##
Dedupe and filtering
##
collapse 6907 dupes to 445 tags (spanning 93.21 Mb), 93.21 covered by all 6 marker scaffolds
dropping 4 lines due to high similarity (>0.950)
    RI strains via selfing

    No. individuals:    95 

    No. phenotypes:     2 
    Percent phenotyped: 100 100 

    No. chromosomes:    6 
        Autosomes:      Ctg001 Ctg002 Ctg003 Ctg004 Ctg005 Ctg006 

    Total markers:      473 
    No. markers:        80 79 80 72 76 86 
    Percent genotyped:  99.9 
    Genotypes (%):      AA:42.7  BB:57.3 
##
Form linkage groups
##
No apparent problems.
  lod n     sixes minlg maxdross
1  13 6 1.0000000    72       NA
2  14 7 0.9978858    72        1
3  15 7 0.9978858    72        1
4  16 7 0.9978858    72        1
5  17 7 0.9978858    72        1
6  18 7 0.9978858    72        1
7  19 7 0.9978858    72        1
8  20 7 0.9978858    72        1
9  21 9 0.9281184    61       18

using minimum LOD 13
473 markers in 0 non-singleton LGs
##
Saving filtered cross data
##
[1] "ML error rate ... "
[1] 0.0005537963
XOs (median 8)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  2.000   6.000   8.000   8.674  11.000  23.000 
XOs > 99% MAD
B2_32 
   23 
        n.mar length ave.spacing max.spacing
1          86   56.3         0.7         2.8
2          80   77.5         1.0         8.5
3          80   82.8         1.0         4.6
4          79  108.4         1.4         5.9
5          76   56.2         0.7         2.1
6          72   49.1         0.7         2.2
overall   473  430.4         0.9         8.5
##
Iterating within LG marker ordering
##
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3333  0.9600  1.3000  1.3460  1.6567  4.4467 
improvement in LL after 50 iterations (1 XO quantile, 95 lines):
[1]    0.0000 -156.8002 -164.4114 -310.2975    0.0000    0.0000
  n.mar length ave.spacing max.spacing
1    86   56.3         0.7         2.8
2    80   77.5         1.0         8.5
3    80   82.8         1.0         4.6
4    79  108.4         1.4         5.9
5    76   56.2         0.7         2.1
6    72   49.1         0.7         2.2
  n.mar length ave.spacing max.spacing
1    86   56.3         0.7         2.8
2    80   49.5         0.6         7.7
3    80   52.3         0.7         2.2
4    79   54.2         0.7         2.3
5    76   56.2         0.7         2.1
6    72   49.1         0.7         2.2
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3333  1.1050  1.4433  1.5398  1.9683  4.1333 
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3333  0.9808  1.3350  1.3571  1.6983  3.5900 
improvement in LL after 50 iterations (0.99 XO quantile, 94 lines):
[1]   0.000000   0.000000 -43.387197 -32.194359   0.000000  -5.850198
  n.mar length ave.spacing max.spacing
1    86   56.3         0.7         2.8
2    80   49.5         0.6         7.7
3    80   52.3         0.7         2.2
4    79   54.2         0.7         2.3
5    76   56.2         0.7         2.1
6    72   49.1         0.7         2.2
  n.mar length ave.spacing max.spacing
1    86   56.3         0.7         2.8
2    80   49.5         0.6         7.7
3    80   50.4         0.6         2.2
4    79   52.7         0.7         2.3
5    76   56.2         0.7         2.1
6    72   45.9         0.6         1.7
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3333  1.0025  1.3583  1.3810  1.7125  3.6233 
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4400  0.9667  1.2367  1.2646  1.5800  2.0133 
improvement in LL after 50 iterations (0.95 XO quantile, 89 lines):
[1] -78.45872 -76.20367 -26.97021 -28.96188 -14.81523 -38.57088
  n.mar length ave.spacing max.spacing
1    86   56.3         0.7         2.8
2    80   49.5         0.6         7.7
3    80   50.4         0.6         2.2
4    79   52.7         0.7         2.3
5    76   56.2         0.7         2.1
6    72   45.9         0.6         1.7
  n.mar length ave.spacing max.spacing
1    86   50.7         0.6         3.0
2    80   47.1         0.6         6.6
3    80   51.6         0.7         2.4
4    79   53.4         0.7         2.4
5    76   55.6         0.7         2.4
6    72   45.2         0.6         1.8
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4133  1.0033  1.2700  1.2821  1.5900  2.0400 
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.6133  0.9783  1.2333  1.2497  1.5200  1.9133 
improvement in LL after 50 iterations (0.9 XO quantile, 80 lines):
[1]  -56.31924  -57.99809  -73.41982  -51.89822  -62.19529 -100.62498
  n.mar length ave.spacing max.spacing
1    86   50.7         0.6         3.0
2    80   47.1         0.6         6.6
3    80   51.6         0.7         2.4
4    79   53.4         0.7         2.4
5    76   55.6         0.7         2.4
6    72   45.2         0.6         1.8
  n.mar length ave.spacing max.spacing
1    86   51.4         0.6         2.0
2    80   47.4         0.6         6.5
3    80   50.5         0.6         2.0
4    79   55.3         0.7         2.1
5    76   56.3         0.8         2.6
6    72   42.3         0.6         2.0
gmap_hifi_q100 Test full reordering by physical distance
gmap_hifi_q100: Of 6 contigs in the map, 0 are unorientable, 3 are discordant (spanning 0 and 50713027 bp)
gmap_hifi_q100 breaks: initial order vs. oriented order
[[1]]
Run Length Encoding
  lengths: int [1:15] 26 1 1 1 22 1 1 1 8 1 ...
  values : int [1:15] 1 2 -1 2 1 2 -1 2 1 2 ...

[[2]]
Run Length Encoding
  lengths: int [1:18] 19 1 1 1 36 1 1 1 7 1 ...
  values : int [1:18] 1 2 -1 2 1 2 -1 2 1 2 ...

[[3]]
Run Length Encoding
  lengths: int 79
  values : int 1

[[4]]
Run Length Encoding
  lengths: int 78
  values : int 1

[[5]]
Run Length Encoding
  lengths: int [1:5] 66 1 1 1 6
  values : int [1:5] 1 2 -1 2 1

[[6]]
Run Length Encoding
  lengths: int [1:10] 53 1 1 1 1 1 10 1 1 1
  values : int [1:10] 1 3 1 -2 -1 4 1 3 -2 1

gmap_hifi_q100 likelihoods for new order
LG 1: LOD 1.613, map length -1.377, order accepted
	LG 2: LOD -10.866, map length -6.754, order rejected
LG 3: no change
LG 4: no change
LG 5: LOD 0.000, map length -0.000, order accepted
LG 6: LOD 3.093, map length -1.313, order accepted
gmap_hifi_q100: Of 6 contigs in the map, 0 are unorientable, 1 are discordant (spanning 0 and 24293083 bp)
gmap_hifi_q100 breaks: initial order vs. oriented order
[[1]]
Run Length Encoding
  lengths: int 85
  values : int 1

[[2]]
Run Length Encoding
  lengths: int [1:18] 19 1 1 1 36 1 1 1 7 1 ...
  values : int [1:18] 1 2 -1 2 1 2 -1 2 1 2 ...

[[3]]
Run Length Encoding
  lengths: int 79
  values : int 1

[[4]]
Run Length Encoding
  lengths: int 78
  values : int 1

[[5]]
Run Length Encoding
  lengths: int 75
  values : int 1

[[6]]
Run Length Encoding
  lengths: int 71
  values : int 1

gmap_hifi_q100 likelihoods for new order
LG 1: no change
	LG 2: LOD -10.866, map length -6.754, order rejected
LG 3: no change
LG 4: no change
LG 5: no change
LG 6: no change
gmap_hifi_q100 Test case-by-case reordering by physical distance
        n.mar length ave.spacing max.spacing
1          86   54.0         0.6         2.8
2          80   49.5         0.6         7.7
3          80   52.3         0.7         2.2
4          79   54.2         0.7         2.3
5          76   55.8         0.7         2.1
6          72   46.2         0.7         1.6
overall   473  312.0         0.7         7.7
Saving cross and map df to /scratch/lmn3/becei/gmap_hifi/rqtl/gmap_hifi_q100_rimap_2.rda
gmap_hifi_q100 Add duplicate markers
gmap_hifi_q100 Order duplicate markers
LG 1, span vs true span 0

LG 2: Ctg001 dupe split over 5 junction
           marker genetic lg marker_scaf         dupe   start     end   scaf
2778 Ctg001.14301  36.388  2      Ctg001        FALSE 4975329 4985873 Ctg001
2779 Ctg001.14301  36.388  2      Ctg001 Ctg001.14251 4942929 4975227 Ctg001
2780 Ctg001.15051  36.920  2      Ctg001 Ctg001.15101 5201301 5326657 Ctg001
       diff     cpos
2778  10646 19310688
2779 351430 19343088
2780 126479 19601460

           marker genetic lg marker_scaf         dupe   start     end   scaf
2795 Ctg001.12101  37.452  2      Ctg001 Ctg001.12151 4360946 4368077 Ctg001
2796 Ctg001.12101  37.452  2      Ctg001        FALSE 4355515 4360705 Ctg001
2797 Ctg001.12851  37.984  2      Ctg001 Ctg001.13401 4728656 4737133 Ctg001
       diff     cpos
2795   7372 20441815
2796 376428 20447246
2797   8636 20820387

           marker genetic lg marker_scaf         dupe   start     end   scaf
2807 Ctg001.12851  37.984  2      Ctg001 Ctg001.12901 4575936 4587531 Ctg001
2808 Ctg001.12851  37.984  2      Ctg001        FALSE 4547985 4575899 Ctg001
2809 Ctg001.13451  38.516  2      Ctg001 Ctg001.13501 4748003 4755018 Ctg001
       diff     cpos
2807  11632 20973107
2808 179119 21001058
2809   7076 21201076

           marker genetic lg marker_scaf         dupe   start     end   scaf
2809 Ctg001.13451  38.516  2      Ctg001 Ctg001.13501 4748003 4755018 Ctg001
2810 Ctg001.13451  38.516  2      Ctg001        FALSE 4737164 4747942 Ctg001
2811  Ctg001.8701  39.048  2      Ctg001 Ctg001.14151 4917611 4929967 Ctg001
       diff     cpos
2809   7076 21201076
2810 182025 21211915
2811  12460 21392362

           marker genetic lg marker_scaf      dupe   start     end   scaf
3064     Ctg001.1  41.736  2      Ctg001 Ctg001.51   68341  146314 Ctg001
3065     Ctg001.1  41.736  2      Ctg001     FALSE    1194   67242 Ctg001
3066 Ctg001.14201  49.451  2      Ctg001     FALSE 4930221 4942465 Ctg001
        diff     cpos
3064   79072 26241632
3065 4875223 26308779
3066 4941272 31237806

LG 2: Ctg001 setting 1 sus diffs > 1Mb to NA
           marker genetic lg marker_scaf  dupe   start     end   scaf    diff
3065     Ctg001.1  41.736  2      Ctg001 FALSE    1194   67242 Ctg001      NA
3066 Ctg001.14201  49.451  2      Ctg001 FALSE 4930221 4942465 Ctg001 4941272
3067 Ctg001.14201  49.451  2      Ctg001   end       0    1193 Ctg001       0
         cpos
3065       NA
3066 31237806
3067 36168027

LG 2, span vs true span -1022953

LG 3: Ctg003 dupe split over 1 junction
           marker genetic lg marker_scaf         dupe    start      end   scaf
3888 Ctg003.40401  27.775  3      Ctg003 Ctg003.41101 10993169 10999419 Ctg003
3889 Ctg003.40401  27.775  3      Ctg003 Ctg003.41151 10999612 11006895 Ctg003
3890 Ctg003.40601  28.130  3      Ctg003        FALSE 10855297 10868035 Ctg003
       diff     cpos
3888   6388 10993170
3889   7476 10999613
3890 138860 11143928

LG 3, span vs true span -270244

LG 4: Ctg002 dupe split over 1 junction
          marker genetic lg marker_scaf        dupe   start     end   scaf
5292 Ctg002.3651  45.000  4      Ctg002 Ctg002.3701 1040767 1055474 Ctg002
5293 Ctg002.3651  45.000  4      Ctg002       FALSE 1026654 1040741 Ctg002
5294 Ctg002.3501  45.435  4      Ctg002 Ctg002.4351 1180945 1191459 Ctg002
       diff     cpos
5292  14733 14011279
5293 150718 14025392
5294  10556 14179683

LG 4, span vs true span -150718

LG 5: Ctg005 dupe split over 1 junction
           marker genetic lg marker_scaf         dupe   start     end   scaf
5664 Ctg005.14301  30.412  5      Ctg005 Ctg005.32151 8695549 8748977 Ctg005
5665 Ctg005.14301  30.412  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
5666 Ctg005.14451  30.944  5      Ctg005        FALSE 3657968 3674747 Ctg005
        diff     cpos
5664 5091022  8695550
5665   52979  8750794
5666 5127209 13843619

LG 5: Ctg005 setting 2 sus diffs > 1Mb to NA
           marker genetic lg marker_scaf         dupe   start     end   scaf
5663 Ctg005.14301  30.412  5      Ctg005 Ctg005.14401 3649427 3657955 Ctg005
5664 Ctg005.14301  30.412  5      Ctg005 Ctg005.32151 8695549 8748977 Ctg005
5665 Ctg005.14301  30.412  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
        diff    cpos
5663    8633 3649428
5664 5091022 8695550
5665      NA      NA

           marker genetic lg marker_scaf         dupe   start     end   scaf
5665 Ctg005.14301  30.412  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
5666 Ctg005.14451  30.944  5      Ctg005        FALSE 3657968 3674747 Ctg005
5667 Ctg005.14451  30.944  5      Ctg005 Ctg005.14501 3674838 3681348 Ctg005
        diff     cpos
5665      NA       NA
5666 5127209 13843619
5667    6601 13860489

LG 5, span vs true span 16792

LG 6, span vs true span 0

gmap_hifi_q100 After duplicate and termini addition:
69.32 Mb ordered (5 contig)
0.00 Mb genetically unorderable (0 contig)
25.32 Mb ambiguous (0 contig)
vs. assembly span 93.21 Mb (1.43 off)
6 contigsgmap_hifi_q99 Test full reordering by physical distance
gmap_hifi_q99: Of 6 contigs in the map, 0 are unorientable, 3 are discordant (spanning 0 and 50713027 bp)
gmap_hifi_q99 breaks: initial order vs. oriented order
[[1]]
Run Length Encoding
  lengths: int [1:15] 26 1 1 1 22 1 1 1 8 1 ...
  values : int [1:15] 1 2 -1 2 1 2 -1 2 1 2 ...

[[2]]
Run Length Encoding
  lengths: int [1:18] 19 1 1 1 36 1 1 1 7 1 ...
  values : int [1:18] 1 2 -1 2 1 2 -1 2 1 2 ...

[[3]]
Run Length Encoding
  lengths: int [1:23] 15 1 1 1 2 1 1 1 9 1 ...
  values : int [1:23] 1 2 -1 2 1 2 -1 2 1 2 ...

[[4]]
Run Length Encoding
  lengths: int [1:13] 30 1 1 1 27 1 1 1 5 1 ...
  values : int [1:13] 1 2 -1 2 1 2 -1 2 1 2 ...

[[5]]
Run Length Encoding
  lengths: int [1:5] 66 1 1 1 6
  values : int [1:5] 1 2 -1 2 1

[[6]]
Run Length Encoding
  lengths: int [1:15] 21 1 1 1 1 1 1 1 27 1 ...
  values : int [1:15] 1 2 -1 2 1 2 -1 2 1 2 ...

gmap_hifi_q99 likelihoods for new order
LG 1: LOD 1.601, map length -1.406, order accepted
	LG 2: LOD -10.920, map length -6.856, order rejected
LG 3: LOD 0.000, map length 0.000, order accepted
LG 4: LOD 0.000, map length -0.000, order accepted
LG 5: LOD 0.000, map length -0.000, order accepted
LG 6: LOD -0.098, map length -0.286, order accepted
gmap_hifi_q99: Of 6 contigs in the map, 0 are unorientable, 1 are discordant (spanning 0 and 24293083 bp)
gmap_hifi_q99 breaks: initial order vs. oriented order
[[1]]
Run Length Encoding
  lengths: int 85
  values : int 1

[[2]]
Run Length Encoding
  lengths: int [1:18] 19 1 1 1 36 1 1 1 7 1 ...
  values : int [1:18] 1 2 -1 2 1 2 -1 2 1 2 ...

[[3]]
Run Length Encoding
  lengths: int 79
  values : int 1

[[4]]
Run Length Encoding
  lengths: int 78
  values : int 1

[[5]]
Run Length Encoding
  lengths: int 75
  values : int 1

[[6]]
Run Length Encoding
  lengths: int 71
  values : int 1

gmap_hifi_q99 likelihoods for new order
LG 1: no change
	LG 2: LOD -10.920, map length -6.856, order rejected
LG 3: no change
LG 4: no change
LG 5: no change
LG 6: no change
gmap_hifi_q99 Test case-by-case reordering by physical distance
        n.mar length ave.spacing max.spacing
1          86   54.6         0.6         2.8
2          80   50.0         0.6         7.8
3          80   50.4         0.6         2.2
4          79   52.7         0.7         2.3
5          76   55.8         0.7         2.1
6          72   45.6         0.6         1.7
overall   473  309.1         0.7         7.8
Saving cross and map df to /scratch/lmn3/becei/gmap_hifi/rqtl/gmap_hifi_q99_rimap_2.rda
gmap_hifi_q99 Add duplicate markers
gmap_hifi_q99 Order duplicate markers
LG 1, span vs true span 0

LG 2: Ctg001 dupe split over 5 junction
           marker genetic lg marker_scaf         dupe   start     end   scaf
2778 Ctg001.14301  36.786  2      Ctg001        FALSE 4975329 4985873 Ctg001
2779 Ctg001.14301  36.786  2      Ctg001 Ctg001.14251 4942929 4975227 Ctg001
2780 Ctg001.15051  37.323  2      Ctg001 Ctg001.15101 5201301 5326657 Ctg001
       diff     cpos
2778  10646 19310688
2779 351430 19343088
2780 126479 19601460

           marker genetic lg marker_scaf         dupe   start     end   scaf
2795 Ctg001.12101  37.861  2      Ctg001 Ctg001.12151 4360946 4368077 Ctg001
2796 Ctg001.12101  37.861  2      Ctg001        FALSE 4355515 4360705 Ctg001
2797 Ctg001.12851  38.399  2      Ctg001 Ctg001.13401 4728656 4737133 Ctg001
       diff     cpos
2795   7372 20441815
2796 376428 20447246
2797   8636 20820387

           marker genetic lg marker_scaf         dupe   start     end   scaf
2807 Ctg001.12851  38.399  2      Ctg001 Ctg001.12901 4575936 4587531 Ctg001
2808 Ctg001.12851  38.399  2      Ctg001        FALSE 4547985 4575899 Ctg001
2809 Ctg001.13451  38.936  2      Ctg001 Ctg001.13501 4748003 4755018 Ctg001
       diff     cpos
2807  11632 20973107
2808 179119 21001058
2809   7076 21201076

           marker genetic lg marker_scaf         dupe   start     end   scaf
2809 Ctg001.13451  38.936  2      Ctg001 Ctg001.13501 4748003 4755018 Ctg001
2810 Ctg001.13451  38.936  2      Ctg001        FALSE 4737164 4747942 Ctg001
2811  Ctg001.8701  39.474  2      Ctg001 Ctg001.14151 4917611 4929967 Ctg001
       diff     cpos
2809   7076 21201076
2810 182025 21211915
2811  12460 21392362

           marker genetic lg marker_scaf      dupe   start     end   scaf
3064     Ctg001.1  42.192  2      Ctg001 Ctg001.51   68341  146314 Ctg001
3065     Ctg001.1  42.192  2      Ctg001     FALSE    1194   67242 Ctg001
3066 Ctg001.14201  50.024  2      Ctg001     FALSE 4930221 4942465 Ctg001
        diff     cpos
3064   79072 26241632
3065 4875223 26308779
3066 4941272 31237806

LG 2: Ctg001 setting 1 sus diffs > 1Mb to NA
           marker genetic lg marker_scaf  dupe   start     end   scaf    diff
3065     Ctg001.1  42.192  2      Ctg001 FALSE    1194   67242 Ctg001      NA
3066 Ctg001.14201  50.024  2      Ctg001 FALSE 4930221 4942465 Ctg001 4941272
3067 Ctg001.14201  50.024  2      Ctg001   end       0    1193 Ctg001       0
         cpos
3065       NA
3066 31237806
3067 36168027

LG 2, span vs true span -1022953

LG 3, span vs true span 0

LG 4, span vs true span 0

LG 5: Ctg005 dupe split over 1 junction
           marker genetic lg marker_scaf         dupe   start     end   scaf
5664 Ctg005.14301  30.746  5      Ctg005 Ctg005.32151 8695549 8748977 Ctg005
5665 Ctg005.14301  30.746  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
5666 Ctg005.14451  31.283  5      Ctg005        FALSE 3657968 3674747 Ctg005
        diff     cpos
5664 5091022  8695550
5665   52979  8750794
5666 5127209 13843619

LG 5: Ctg005 setting 2 sus diffs > 1Mb to NA
           marker genetic lg marker_scaf         dupe   start     end   scaf
5663 Ctg005.14301  30.746  5      Ctg005 Ctg005.14401 3649427 3657955 Ctg005
5664 Ctg005.14301  30.746  5      Ctg005 Ctg005.32151 8695549 8748977 Ctg005
5665 Ctg005.14301  30.746  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
        diff    cpos
5663    8633 3649428
5664 5091022 8695550
5665      NA      NA

           marker genetic lg marker_scaf         dupe   start     end   scaf
5665 Ctg005.14301  30.746  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
5666 Ctg005.14451  31.283  5      Ctg005        FALSE 3657968 3674747 Ctg005
5667 Ctg005.14451  31.283  5      Ctg005 Ctg005.14501 3674838 3681348 Ctg005
        diff     cpos
5665      NA       NA
5666 5127209 13843619
5667    6601 13860489

LG 5, span vs true span 16792

LG 6, span vs true span 0

gmap_hifi_q99 After duplicate and termini addition:
68.90 Mb ordered (5 contig)
0.00 Mb genetically unorderable (0 contig)
25.32 Mb ambiguous (0 contig)
vs. assembly span 93.21 Mb (1.01 off)
6 contigsgmap_hifi_q95 Test full reordering by physical distance
gmap_hifi_q95: Of 6 contigs in the map, 0 are unorientable, 3 are discordant (spanning 0 and 52011748 bp)
gmap_hifi_q95 breaks: initial order vs. oriented order
[[1]]
Run Length Encoding
  lengths: int [1:37] 26 1 1 1 15 1 1 1 4 1 ...
  values : int [1:37] 1 2 -1 2 1 2 -1 2 1 2 ...

[[2]]
Run Length Encoding
  lengths: int [1:26] 6 1 1 1 3 1 1 1 25 1 ...
  values : int [1:26] 1 2 -1 2 1 2 -1 2 1 2 ...

[[3]]
Run Length Encoding
  lengths: int [1:13] 44 1 1 1 9 1 1 1 1 1 ...
  values : int [1:13] 1 2 -1 2 1 2 -1 3 -1 2 ...

[[4]]
Run Length Encoding
  lengths: int [1:13] 8 1 1 1 1 1 1 1 2 1 ...
  values : int [1:13] 1 2 -1 2 1 2 -1 2 1 2 ...

[[5]]
Run Length Encoding
  lengths: int [1:13] 23 1 1 1 24 1 1 1 13 1 ...
  values : int [1:13] 1 2 -1 2 1 2 -1 2 1 2 ...

[[6]]
Run Length Encoding
  lengths: int [1:24] 21 1 1 1 1 1 1 1 3 1 ...
  values : int [1:24] 1 2 -1 2 1 2 -1 2 1 2 ...

gmap_hifi_q95 likelihoods for new order
LG 1: LOD 0.000, map length -0.000, order accepted
	LG 2: LOD -12.695, map length -0.874, order rejected
LG 3: LOD -0.000, map length 0.000, order accepted
LG 4: LOD 0.000, map length -0.000, order accepted
LG 5: LOD 0.000, map length -0.000, order accepted
LG 6: LOD -0.111, map length -0.317, order accepted
gmap_hifi_q95: Of 6 contigs in the map, 0 are unorientable, 1 are discordant (spanning 0 and 24293083 bp)
gmap_hifi_q95 breaks: initial order vs. oriented order
[[1]]
Run Length Encoding
  lengths: int 85
  values : int 1

[[2]]
Run Length Encoding
  lengths: int [1:26] 6 1 1 1 3 1 1 1 25 1 ...
  values : int [1:26] 1 2 -1 2 1 2 -1 2 1 2 ...

[[3]]
Run Length Encoding
  lengths: int 79
  values : int 1

[[4]]
Run Length Encoding
  lengths: int 78
  values : int 1

[[5]]
Run Length Encoding
  lengths: int 75
  values : int 1

[[6]]
Run Length Encoding
  lengths: int 71
  values : int 1

gmap_hifi_q95 likelihoods for new order
LG 1: no change
	LG 2: LOD -12.695, map length -0.874, order rejected
LG 3: no change
LG 4: no change
LG 5: no change
LG 6: no change
gmap_hifi_q95 Test case-by-case reordering by physical distance
        n.mar length ave.spacing max.spacing
1          86   50.7         0.6         3.0
2          80   47.1         0.6         6.6
3          80   51.6         0.7         2.4
4          79   53.4         0.7         2.4
5          76   55.6         0.7         2.4
6          72   44.9         0.6         1.8
overall   473  303.3         0.6         6.6
Saving cross and map df to /scratch/lmn3/becei/gmap_hifi/rqtl/gmap_hifi_q95_rimap_2.rda
gmap_hifi_q95 Add duplicate markers
gmap_hifi_q95 Order duplicate markers
LG 1, span vs true span 0

LG 2: Ctg001 dupe split over 5 junction
           marker genetic lg marker_scaf         dupe   start     end   scaf
2778 Ctg001.14301  36.040  2      Ctg001        FALSE 4975329 4985873 Ctg001
2779 Ctg001.14301  36.040  2      Ctg001 Ctg001.14251 4942929 4975227 Ctg001
2780 Ctg001.15051  36.608  2      Ctg001 Ctg001.15101 5201301 5326657 Ctg001
       diff     cpos
2778  10646 19310688
2779 351430 19343088
2780 126479 19601460

           marker genetic lg marker_scaf         dupe   start     end   scaf
2795 Ctg001.12101  37.176  2      Ctg001 Ctg001.12151 4360946 4368077 Ctg001
2796 Ctg001.12101  37.176  2      Ctg001        FALSE 4355515 4360705 Ctg001
2797 Ctg001.12851  37.745  2      Ctg001 Ctg001.13401 4728656 4737133 Ctg001
       diff     cpos
2795   7372 20441815
2796 376428 20447246
2797   8636 20820387

           marker genetic lg marker_scaf         dupe   start     end   scaf
2807 Ctg001.12851  37.745  2      Ctg001 Ctg001.12901 4575936 4587531 Ctg001
2808 Ctg001.12851  37.745  2      Ctg001        FALSE 4547985 4575899 Ctg001
2809 Ctg001.13451  38.313  2      Ctg001 Ctg001.13501 4748003 4755018 Ctg001
       diff     cpos
2807  11632 20973107
2808 179119 21001058
2809   7076 21201076

           marker genetic lg marker_scaf         dupe   start     end   scaf
2809 Ctg001.13451  38.313  2      Ctg001 Ctg001.13501 4748003 4755018 Ctg001
2810 Ctg001.13451  38.313  2      Ctg001        FALSE 4737164 4747942 Ctg001
2811  Ctg001.8701  38.881  2      Ctg001 Ctg001.14151 4917611 4929967 Ctg001
       diff     cpos
2809   7076 21201076
2810 182025 21211915
2811  12460 21392362

           marker genetic lg marker_scaf      dupe   start     end   scaf
3064     Ctg001.1  40.590  2      Ctg001 Ctg001.51   68341  146314 Ctg001
3065     Ctg001.1  40.590  2      Ctg001     FALSE    1194   67242 Ctg001
3066 Ctg001.14201  47.147  2      Ctg001     FALSE 4930221 4942465 Ctg001
        diff     cpos
3064   79072 26241632
3065 4875223 26308779
3066 4941272 31237806

LG 2: Ctg001 setting 1 sus diffs > 1Mb to NA
           marker genetic lg marker_scaf  dupe   start     end   scaf    diff
3065     Ctg001.1  40.590  2      Ctg001 FALSE    1194   67242 Ctg001      NA
3066 Ctg001.14201  47.147  2      Ctg001 FALSE 4930221 4942465 Ctg001 4941272
3067 Ctg001.14201  47.147  2      Ctg001   end       0    1193 Ctg001       0
         cpos
3065       NA
3066 31237806
3067 36168027

LG 2, span vs true span -1022953

LG 3, span vs true span 0

LG 4, span vs true span 0

LG 5: Ctg005 dupe split over 1 junction
           marker genetic lg marker_scaf         dupe   start     end   scaf
5664 Ctg005.14301  29.641  5      Ctg005 Ctg005.32151 8695549 8748977 Ctg005
5665 Ctg005.14301  29.641  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
5666 Ctg005.14451  30.210  5      Ctg005        FALSE 3657968 3674747 Ctg005
        diff     cpos
5664 5091022  8695550
5665   52979  8750794
5666 5127209 13843619

LG 5: Ctg005 setting 2 sus diffs > 1Mb to NA
           marker genetic lg marker_scaf         dupe   start     end   scaf
5663 Ctg005.14301  29.641  5      Ctg005 Ctg005.14401 3649427 3657955 Ctg005
5664 Ctg005.14301  29.641  5      Ctg005 Ctg005.32151 8695549 8748977 Ctg005
5665 Ctg005.14301  29.641  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
        diff    cpos
5663    8633 3649428
5664 5091022 8695550
5665      NA      NA

           marker genetic lg marker_scaf         dupe   start     end   scaf
5665 Ctg005.14301  29.641  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
5666 Ctg005.14451  30.210  5      Ctg005        FALSE 3657968 3674747 Ctg005
5667 Ctg005.14451  30.210  5      Ctg005 Ctg005.14501 3674838 3681348 Ctg005
        diff     cpos
5665      NA       NA
5666 5127209 13843619
5667    6601 13860489

LG 5, span vs true span 16792

LG 6, span vs true span 0

gmap_hifi_q95 After duplicate and termini addition:
68.90 Mb ordered (5 contig)
0.00 Mb genetically unorderable (0 contig)
25.32 Mb ambiguous (0 contig)
vs. assembly span 93.21 Mb (1.01 off)
6 contigsgmap_hifi_q90 Test full reordering by physical distance
gmap_hifi_q90: Of 6 contigs in the map, 0 are unorientable, 1 are discordant (spanning 0 and 24293083 bp)
gmap_hifi_q90 breaks: initial order vs. oriented order
[[1]]
Run Length Encoding
  lengths: int [1:45] 2 1 1 1 2 1 1 1 8 1 ...
  values : int [1:45] 1 2 -1 2 1 2 -1 2 1 2 ...

[[2]]
Run Length Encoding
  lengths: int [1:37] 1 1 1 1 1 1 1 1 1 1 ...
  values : int [1:37] -6 -2 1 6 -4 1 2 -1 5 -1 ...

[[3]]
Run Length Encoding
  lengths: int [1:32] 14 1 1 2 1 1 3 1 1 1 ...
  values : int [1:32] 1 2 -1 2 -1 2 1 2 -1 2 ...

[[4]]
Run Length Encoding
  lengths: int [1:25] 8 1 1 1 1 1 1 2 1 1 ...
  values : int [1:25] 1 2 -1 2 1 2 -1 2 -1 2 ...

[[5]]
Run Length Encoding
  lengths: int [1:23] 6 1 1 1 22 1 1 1 6 1 ...
  values : int [1:23] 1 2 -1 2 1 2 -1 2 1 2 ...

[[6]]
Run Length Encoding
  lengths: int [1:33] 11 1 1 1 1 1 4 1 1 1 ...
  values : int [1:33] 1 2 -1 3 -1 2 1 2 -1 3 ...

gmap_hifi_q90 likelihoods for new order
LG 1: LOD 0.000, map length -0.000, order accepted
	LG 2: LOD -12.114, map length -1.626, order rejected
LG 3: LOD 0.000, map length 0.000, order accepted
LG 4: LOD 0.000, map length -0.000, order accepted
LG 5: LOD 0.000, map length -0.000, order accepted
LG 6: LOD 0.000, map length -0.000, order accepted
gmap_hifi_q90: Of 6 contigs in the map, 0 are unorientable, 1 are discordant (spanning 0 and 24293083 bp)
gmap_hifi_q90 breaks: initial order vs. oriented order
[[1]]
Run Length Encoding
  lengths: int 85
  values : int 1

[[2]]
Run Length Encoding
  lengths: int [1:37] 1 1 1 1 1 1 1 1 1 1 ...
  values : int [1:37] -6 -2 1 6 -4 1 2 -1 5 -1 ...

[[3]]
Run Length Encoding
  lengths: int 79
  values : int 1

[[4]]
Run Length Encoding
  lengths: int 78
  values : int 1

[[5]]
Run Length Encoding
  lengths: int 75
  values : int 1

[[6]]
Run Length Encoding
  lengths: int 71
  values : int 1

gmap_hifi_q90 likelihoods for new order
LG 1: no change
	LG 2: LOD -12.114, map length -1.626, order rejected
LG 3: no change
LG 4: no change
LG 5: no change
LG 6: no change
gmap_hifi_q90 Test case-by-case reordering by physical distance
        n.mar length ave.spacing max.spacing
1          86   51.4         0.6         2.0
2          80   47.4         0.6         6.5
3          80   50.5         0.6         2.0
4          79   55.3         0.7         2.1
5          76   56.3         0.8         2.6
6          72   42.3         0.6         2.0
overall   473  303.2         0.6         6.5
Saving cross and map df to /scratch/lmn3/becei/gmap_hifi/rqtl/gmap_hifi_q90_rimap_2.rda
gmap_hifi_q90 Add duplicate markers
gmap_hifi_q90 Order duplicate markers
LG 1, span vs true span 0

LG 2: Ctg001 dupe split over 6 junction
           marker genetic lg marker_scaf  dupe    start      end   scaf
1026 Ctg001.14201       0  2      Ctg001   end 24286016 24293084 Ctg001
1027 Ctg001.14201       0  2      Ctg001 FALSE  4930221  4942465 Ctg001
         diff  cpos
1026 19350619     1
1027  4875223 12246

           marker genetic lg marker_scaf  dupe    start      end   scaf    diff
1026 Ctg001.14201   0.000  2      Ctg001   end 24286016 24293084 Ctg001      NA
1027 Ctg001.14201   0.000  2      Ctg001 FALSE  4930221  4942465 Ctg001 4875223
1028     Ctg001.1   6.533  2      Ctg001 FALSE     1194    67242 Ctg001   79072
        cpos
1026      NA
1027   12246
1028 4941273

           marker genetic lg marker_scaf         dupe   start     end   scaf
1283  Ctg001.8701   7.815  2      Ctg001 Ctg001.14101 4911974 4917507 Ctg001
1284  Ctg001.8701   7.815  2      Ctg001 Ctg001.14151 4917611 4929967 Ctg001
1285 Ctg001.12851   8.448  2      Ctg001        FALSE 4547985 4575899 Ctg001
       diff     cpos
1283  12460  9852053
1284 354068  9857690
1285  11632 10227316

           marker genetic lg marker_scaf         dupe   start     end   scaf
1295 Ctg001.12851   8.448  2      Ctg001 Ctg001.13351 4723320 4728497 Ctg001
1296 Ctg001.12851   8.448  2      Ctg001 Ctg001.13401 4728656 4737133 Ctg001
1297 Ctg001.12101   9.081  2      Ctg001        FALSE 4355515 4360705 Ctg001
       diff     cpos
1295   8636 10402651
1296 376428 10407987
1297   7372 10781128

           marker genetic lg marker_scaf         dupe   start     end   scaf
1312 Ctg001.15051   9.714  2      Ctg001        FALSE 5174268 5200178 Ctg001
1313 Ctg001.15051   9.714  2      Ctg001 Ctg001.15101 5201301 5326657 Ctg001
1314 Ctg001.14301  10.347  2      Ctg001 Ctg001.14251 4942929 4975227 Ctg001
       diff     cpos
1312 126479 11599881
1313 351430 11626914
1314  10646 11885286

            marker genetic lg marker_scaf          dupe    start      end
3065 Ctg001.101151  47.388  2      Ctg001 Ctg001.101901 23984500 24270244
3066 Ctg001.101151  47.388  2      Ctg001 Ctg001.101951 24272878 24286015
3067 Ctg001.101151  47.388  2      Ctg001           end        0     1193
       scaf     diff     cpos
3065 Ctg001    15771 30926857
3066 Ctg001 24284822 31215235
3067 Ctg001        0 55488113

LG 2, span vs true span -1015877

LG 3, span vs true span 0

LG 4, span vs true span 0

LG 5: Ctg005 dupe split over 1 junction
           marker genetic lg marker_scaf         dupe   start     end   scaf
6096 Ctg005.14451  25.733  5      Ctg005 Ctg005.14501 3674838 3681348 Ctg005
6097 Ctg005.14451  25.733  5      Ctg005        FALSE 3657968 3674747 Ctg005
6098 Ctg005.14301  26.366  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
        diff     cpos
6096    6601  9705130
6097 5127209  9722000
6098   52979 14814825

LG 5: Ctg005 setting 1 sus diffs > 1Mb to NA
           marker genetic lg marker_scaf         dupe   start     end   scaf
6098 Ctg005.14301  26.366  5      Ctg005 Ctg005.32201 8750793 8801956 Ctg005
6099 Ctg005.14301  26.366  5      Ctg005 Ctg005.32151 8695549 8748977 Ctg005
6100 Ctg005.14301  26.366  5      Ctg005 Ctg005.14401 3649427 3657955 Ctg005
        diff     cpos
6098   52979 14814825
6099 5091022 14870069
6100    8633 19916191

LG 5, span vs true span -36187

LG 6, span vs true span 0

gmap_hifi_q90 After duplicate and termini addition:
68.96 Mb ordered (5 contig)
0.00 Mb genetically unorderable (0 contig)
25.31 Mb ambiguous (0 contig)
vs. assembly span 93.21 Mb (1.05 off)
6 contigs